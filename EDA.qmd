---
title: "EDA"
format:
  html:
    toc: true
    html-math-method: katex
    css: styles.css
---

```{r}
library(tidyverse)
library()
```



## Explore data

Frequency distribution of factor variables by count.

4 columns ignored with more than 50 categories.

first_name: 3138 categories

last_name: 3723 categories

DOB: 3446 categories

job_title: 196 categories

```{r}
summary(CustomerDemographic$past_3_years_bike_related_purchases)
boxplot(CustomerDemographic$past_3_years_bike_related_purchases, horizontal = TRUE)
```

```{r}
# from DataExplorer

# plot factor variables based on frequency (number of customers in each category)
plot_bar(CustomerDemographic, 
         nrow = 2, ncol = 2)

# with indicates name of continuous feature to be summed. 
# default is NULL, i.e., frequency.
plot_bar(CustomerDemographic, 
         with = "past_3_years_bike_related_purchases",
         nrow = 2, ncol = 2)
```

Gender distribution is pretty balanced, so we will not have any gender bias in training.

Most of the customers in 2017 are in the Mass segment and work in Manufacturing, Financial Services, and Health.

This majority of the customers also have the most bike related purchases in the last 3 years.

```{r}
# Assuming your data frame is called CustomerDemographic
CustomerDemographic |>
  group_by(job_industry_category) |>
  summarise(total_purchases = sum(past_3_years_bike_related_purchases, na.rm = TRUE)) |>
  arrange(desc(total_purchases)) |>
  ggplot(aes(x = reorder(job_industry_category, total_purchases), 
             y = total_purchases, 
             by = job_industry_category)) +
  geom_bar(stat = "identity") +
  labs(title = "Bike Purchases by Job Industry Category",
       x = "Job Industry Category",
       y = "Total Past 3 Years Bike Related Purchases") +
  coord_flip()
```

```{r}
plot_bar(CustomerDemographic, 
         by = 'gender', 
         ncol = 2)
```

Customers who did not provide their gender information appear to work mostly in IT.

```{r}
nrow(
  CustomerDemographic |> 
    filter(job_industry_category == "IT",
           gender == "U")
)

nrow(
  CustomerDemographic |> 
    filter(gender == "U")
)
```

A [2020 study](https://anitab.org/research-and-impact/top-companies/2020-results/) by the AnitaB.org Institute found that women make up 28.8% of the tech workforce, a steady increase from the past few years \-- 25.9% in 2018 and 26.2% in 2019.

So we will assume/expect that majority of U gender customers are Male.

```{r}
# current gender distribution, before imputation
table(
  (CustomerDemographic |> 
     filter(job_industry_category == "IT"))[, "gender"])
```

```{r}
plot_bar(CustomerDemographic, 
         by = 'wealth_segment', 
         ncol = 2)
```

```{r}
plot_bar(CustomerDemographic, 
         by = 'job_industry_category', 
         ncol = 2)
```

## 

```{r}
# library(flextable)
dlookr::diagnose_numeric(CustomerDemographic)
```





























